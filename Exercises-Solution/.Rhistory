top_words <- lapply(1:length(list_dtms), function(x)  sort(rowSums(as.matrix(list_dtms[[x]])), decreasing=TRUE))
top_words_df <- do.call(cbind.data.frame, lapply(top_words, function(i) head(names(i),20)))
colnames(top_words_df) <- lapply(1:length(list_dtms), function(i) paste0("corpus",i))
top_words_df[1:5,1:5]
list_dtms <- lapply(list_corpora1, function(i) TermDocumentMatrix(i))
list_corpora1
list_corpora1[[1]]
inspectlist_corpora1[[1]]
inspect(list_corpora1[[1]])
inspect(list_corpora1[[50]])
list_corpora1 <- lapply(list_corpora, function(i) tm_map(i, FUN = tm_reduce, tmFuns = funcs))
inspect(list_corpora1[[50]])
list_dtms <- lapply(list_corpora1, function(i) TermDocumentMatrix(i))
TermDocumentMatrix(list_corpora1[[50]])
TermDocumentMatrix(list_corpora1[50])
TermDocumentMatrix(list_corpora1[[50]])
skipWords <- function(x) removeWords(x, stopwords("english"))
removeSpecialChars <- function(x) gsub("[^a-zA-Z0-9 ]","",x)
#removeSpecialChars
funcs <- list(removePunctuation, removeNumbers, content_transformer(tolower), skipWords, stripWhitespace)
# FILTER EMPTY FILES
# todo
# Load Data
files <- list.files("C:\\Users\\j_huel12\\Downloads\\ico\\Whitepaper\\lorem", full.name=T)
files <- unlist(lapply(files, function(x) paste0("file://",x)))
list_corpora <- lapply(files, function(i) VCorpus(URISource(i)))
list_corpora1 <- lapply(list_corpora, function(i) tm_map(i, FUN = tm_reduce, tmFuns = funcs))
list_dtms <- lapply(list_corpora1, function(i) TermDocumentMatrix(i))
list_corpora1[[50]]
inspect(list_corpora1[[50]])
inspect(list_corpora1[[[50]]])
inspect(list_corpora1[[50]])
inspect(list_corpora[[50]])
funcs <- list(removePunctuation, removeSpecialChars, removeNumbers, content_transformer(tolower), skipWords, stripWhitespace)
list_corpora1 <- lapply(list_corpora, function(i) tm_map(i, FUN = tm_reduce, tmFuns = funcs))
inspect(list_corpora1[[50]])
inspect(list_corpora1[[1]])
funcs <- list(removePunctuation, content_transformer(removeSpecialChars), removeNumbers, content_transformer(tolower), skipWords, stripWhitespace)
list_corpora1 <- lapply(list_corpora, function(i) tm_map(i, FUN = tm_reduce, tmFuns = funcs))
inspect(list_corpora1[[1]])
files <- list.files("C:\\Users\\j_huel12\\Downloads\\ico\\Whitepaper\\lorem", full.name=T)
files <- unlist(lapply(files, function(x) paste0("file://",x)))
list_corpora <- lapply(files, function(i) VCorpus(URISource(i)))
list_corpora1 <- lapply(list_corpora, function(i) tm_map(i, FUN = tm_reduce, tmFuns = funcs))
list_dtms <- lapply(list_corpora1, function(i) TermDocumentMatrix(i))
# list_dtms <- lapply(list_corpora1, function(i) TermDocumentMatrix(i, control = list(tokenize = bitok)))
# list_dtms <- lapply(list_corpora1, function(i) TermDocumentMatrix(i, control = list(tokenize = tritok)))
# list_dtms <- lapply(list_corpora1, function(i) TermDocumentMatrix(i, control = list(tokenize = quatok)))
top_words <- lapply(1:length(list_dtms), function(x)  sort(rowSums(as.matrix(list_dtms[[x]])), decreasing=TRUE))
top_words_df <- do.call(cbind.data.frame, lapply(top_words, function(i) head(names(i),20)))
colnames(top_words_df) <- lapply(1:length(list_dtms), function(i) paste0("corpus",i))
top_words_df[1:5,1:5]
inspect(list_corpora1[[1]])
inspect(list_corpora1[[1]].text)
inspect(list_corpora1[[1]]$text)
inspect(list_corpora1[[1]])
inspect(list_corpora1[[1]][[1]])
inspect(list_corpora1[[1]][[1]])
list_corpora1[[1]][[1]]
list_corpora1[[1]][[1]]$content
length(list_corpora1[[1]][[1]]$content[157])
strlen(list_corpora1[[1]][[1]]$content[157])
nchar(list_corpora1[[1]][[1]]$content[157])
nchar(list_corpora1[[1]][[1]]$content[158])
nchar(list_corpora1[[1]][[1]]$content[161])
test <- list_corpora1[[1]]
test
test[[1]]
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
trim(" ")
trim("   ")
trim(" s  ")
test <- tm_filter(test, function(x) trim(x) > 0)
test[[1]]
test
test
test[1]
test[[1]
]
test$content
test
inspect(test)
test <- list_corpora1[[1]]
inspect(test)
inspect(test[[1]])
test[[1]]
test[[1]][[1]]
test[[1]][[2]]
test[[1]][[3]]
test[[1]][[2]]
test[[1]]
test[[1]][[1]]
vecc <- test[[1]][[1]]
vecc
vecc <- vec[which(trim(vecc > 0)),]
vecc <- vecc[which(nchar(trim(vecc > 0))),]
vecc <- vecc[which(nchar(trim(vecc) > 0)),]
vecc <- vecc[which(nchar(trim(vecc)) > 0),]
which(nchar(trim(vecc)) > 0)
vecc[which(nchar(trim(vecc)) > 0),]
vecc[which(nchar(trim(vecc)) > 0)]
vecc <- vecc[which(nchar(trim(vecc)) > 0)]
test[[1]][[1]] <- vecc
inspect(test)
inspect(test[[1]])
getTransformations()
?stripWhitespace
stripWhitespace(" asd a    asd ")
stripWhitespace(" asd a    asd\n \n as ")
?SimpleCorpus
files <- list.files("C:\\Users\\j_huel12\\Downloads\\ico\\Whitepaper\\lorem", full.name=T)
files <- unlist(lapply(files, function(x) paste0("file://",x)))
list_corpora <- lapply(files, function(i) SimpleCorpus(URISource(i)))
list_corpora1 <- lapply(list_corpora, function(i) tm_map(i, FUN = tm_reduce, tmFuns = funcs))
list_dtms <- lapply(list_corpora1, function(i) TermDocumentMatrix(i))
files[1]
read.file(files[1])
readChar(files[1], file.info(files[1])$size)
readChar(files[1], file.info(files[1])$size)
readChar
?readChar
file.info(files[1])
file.info(lorem/ADITUS.txt)
file.info("lorem/ADITUS.txt")
file.info("lorem\ADITUS.txt")
file.info("lorem\\ADITUS.txt")
file.info("ADITUS.txt")
getwd
getwd()
file.info("C:\\Users\\j_huel12\\Downloads\\ico\\Whitepaper\\lorem\\ADITUS.txt")
ff <- "C:\\Users\\j_huel12\\Downloads\\ico\\Whitepaper\\lorem\\ADITUS.txt"
readChar(ff, file.info(ff)$size)
stripWhitespace(readChar(ff, file.info(ff)$size))
?SimpleCorpus
tt <- VectorSource(ff)
tt
inspect(Tt)
inspect(tt)
SimpleCorpus(tt)
tt <- SimpleCorpus(tt)
inspect(tt)
inspect(tt[[1]]
)
tt
ff
files <- list.files("C:\\Users\\j_huel12\\Downloads\\ico\\Whitepaper\\lorem", full.name=T)
files
file.info("C:\\Users\\j_huel12\\Downloads\\ico\\Whitepaper\\lorem/POE.txt" )
list_content <- lapply(files, function(x) readChar(x, file.info(x)$size))
list_content
list_corpora <- lapply(files, function(i) SimpleCorpus(VectorSource(i)))
list_corpora
list_corpora[[1]]
list_corpora[[1]][[1]]
inspect(list_corpora[[1]][[1]])
inspect(list_corpora[[1]][[1]]$content)
list_corpora[[1]][[1]]$content
list_content[[1]]
list_corpora <- lapply(list_content, function(i) SimpleCorpus(VectorSource(i)))
list_corpora[[1]]
list_corpora[[1]]$`1`
list_corpora[[1]][[1]]
list_corpora[[1]][[1]]$content
list_corpora1 <- lapply(list_corpora, function(i) tm_map(i, FUN = tm_reduce, tmFuns = funcs))
list_corpora1 <- lapply(list_corpora, function(i) tm_map(i, FUN = tm_reduce, tmFuns = funcs))
list_corop
inspect(list_corpora)
inspect(list_corpora[[1]])
?SimpleCorpus
list_content <- lapply(files, function(x) readChar(x, file.info(x)$size))
list_corpora <- lapply(list_content, function(i) VCorpus(VectorSource(i)))
list_corpora1 <- lapply(list_corpora, function(i) tm_map(i, FUN = tm_reduce, tmFuns = funcs))
list_corpora1[[1]]
list_corpora1[[1]][[1]]
list_corpora1[[1]][[1]]$content
funcs <- list(stripWhitespace, stripWhitespace, skipWords, removePunctuation, removeNumbers, content_transformer(tolower))
# FILTER EMPTY FILES
# todo
# Load Data
files <- list.files("C:\\Users\\j_huel12\\Downloads\\ico\\Whitepaper\\lorem", full.name=T)
list_content <- lapply(files, function(x) readChar(x, file.info(x)$size))
list_corpora <- lapply(list_content, function(i) VCorpus(VectorSource(i)))
list_corpora1 <- lapply(list_corpora, function(i) tm_map(i, FUN = tm_reduce, tmFuns = funcs))
list_dtms <- lapply(list_corpora1, function(i) TermDocumentMatrix(i))
list_corpora1[[1]][[1]]$content
top_words <- lapply(1:length(list_dtms), function(x)  sort(rowSums(as.matrix(list_dtms[[x]])), decreasing=TRUE))
top_words_df <- do.call(cbind.data.frame, lapply(top_words, function(i) head(names(i),20)))
colnames(top_words_df) <- lapply(1:length(list_dtms), function(i) paste0("corpus",i))
top_words_df[1:5,1:5]
list_dtms <- lapply(list_corpora1, function(i) TermDocumentMatrix(i, control = list(tokenize = bitok)))
top_words <- lapply(1:length(list_dtms), function(x)  sort(rowSums(as.matrix(list_dtms[[x]])), decreasing=TRUE))
top_words_df <- do.call(cbind.data.frame, lapply(top_words, function(i) head(names(i),20)))
colnames(top_words_df) <- lapply(1:length(list_dtms), function(i) paste0("corpus",i))
top_words_df[1:5,1:5]
list_corpora1[[1]][[2]]
list_corpora1[[1]]
list_corpora1[[1]][[1]]
list_corpora1[[1]][[1]]$meta
list.files("C:\\Users\\j_huel12\\Downloads\\ico\\Whitepaper\\lorem", full.name=F)
colnames(top_words_df) <- list.files("C:\\Users\\j_huel12\\Downloads\\ico\\Whitepaper\\lorem", full.name=F)
top_words_df[1:5,1:5]
top_words_df[1:10,]
library(igraph)
install.packages("tidyverse")
install.packages("lme4")
install.packages("lmerTest")
install.packages("ez")
dataset
# Input load. Please do not change #
`dataset` = read.csv('C:/Users/j_huel12/REditorWrapper_84d6b1bc-338e-4126-a525-1acacae0f41f/input_df_3dd8a9b4-03e9-42e6-aa4c-365209e79528.csv', check.names = FALSE, encoding = "UTF-8", blank.lines.skip = FALSE);
# Original Script. Please update your script content here and once completed copy below section back to the original editing window #
dataset
summary(dataset)
head(dataset)
head(dataset,100)
head(dataset,-1100)
tail(dataset, 10)
?sample
sample(dataset, 10)
summary(dataset)
library(dplyr)
sample_n(dataset, 10)
sample_n(dataset, 10)
plot.table(sample_n(dataset, 10))
View(dataset)
gsub("[^0-9.]", "", dataset$`User Interacted With Member`)
dataset$`User Interacted With Member` <- gsub("[^0-9.]", "", dataset$`User Interacted With Member`)
head(dataset)
View(dataset)
temp<- read.csv("https://raw.githubusercontent.com/PrisonRodeo/GSERM-Oslo-2019-git/master/Data/HIVDeaths.csv")
temp<- read.csv("https://raw.githubusercontent.com/PrisonRodeo/GSERM-Oslo-2019-git/master/Data/HIVDeaths.csv", header=T)
head(temp)
HIV<-temp
HIV<-HIV[ which(is.na(HIV$HIVDeathRate)==FALSE), ]
HIV$LnDeathPM <- log(HIV$HIVDeathRate*1000)
rm(temp)
HLMfit1<-lmer(LnDeathPM~GDPLagK+(GDPLagK|ISO3)+GDPGrowthLag+OPENLag+POLITYLag+POLITYSQLag+CivilWarDummy+
+ InterstateWarLag+BatDeaths1000Lag,data=HIV,REML=FALSE)
HLMfit1<-lmer(LnDeathPM~GDPLagK+(GDPLagK|ISO3)+GDPGrowthLag+OPENLag+POLITYLag+POLITYSQLag+CivilWarDummy+
InterstateWarLag+BatDeaths1000Lag,data=HIV,REML=FALSE)
library(lmer)
library(lme4
)
HLMfit1<-lmer(LnDeathPM~GDPLagK+(GDPLagK|ISO3)+GDPGrowthLag+OPENLag+POLITYLag+POLITYSQLag+CivilWarDummy+
InterstateWarLag+BatDeaths1000Lag,data=HIV,REML=FALSE)
Bs<-data.frame(coef(HLMfit1)[1])
Bs
head(Bs)
order(Bs$ISO3.GDPLagK)
?order
Bs[order(Bs$ISO3.GDPLagK, decreasing = T),]
install.packages("rmarkdown")
install.packages("rmarkdown")
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
knitr::opts_chunk$set(echo = TRUE)
fit.gee.in <- geeglm(fail~sanctionsl1+forcel1+growthpc+lngdppc+democl1+
democlnt+mixedl1+mixedlnt+age+ot3+X_spline1+X_spline2+
X_spline3,data=df2,id=ccode,family=gaussian,
corstr="independence")
library(RCurl)
library(dplyr)
library(geepack)
library(survival)
library(glmmML)
df<-read.csv(textConnection(getURL("https://raw.githubusercontent.com/PrisonRodeo/GSERM-Oslo-2019-git/master/Exercises/GSERM-Oslo-2019-ExOne.csv")))
df2 <- filter(df, is.na(fail)==FALSE, is.na(sanctionsl1)==FALSE,
is.na(growthpc)==FALSE, is.na(lngdppc)==FALSE,
is.na(democl1)==FALSE, is.na(democlnt)==FALSE,
is.na(mixedl1)==FALSE, is.na(mixedlnt)==FALSE,
is.na(age)==FALSE, is.na(ot3)==FALSE,
is.na(X_spline1)==FALSE,is.na(ccode)==FALSE)
fit.gee.in <- geeglm(fail~sanctionsl1+forcel1+growthpc+lngdppc+democl1+
democlnt+mixedl1+mixedlnt+age+ot3+X_spline1+X_spline2+
X_spline3,data=df2,id=ccode,family=gaussian,
corstr="independence")
fit.gee.ex <- geeglm(fail~sanctionsl1+forcel1+growthpc+lngdppc+democl1+
democlnt+mixedl1+mixedlnt+age+ot3+X_spline1+X_spline2+
X_spline3,data=df2,id=ccode,family=gaussian,
corstr="exchangeable")
fit.gee.ar <- geeglm(fail~sanctionsl1+forcel1+growthpc+lngdppc+democl1+
democlnt+mixedl1+mixedlnt+age+ot3+X_spline1+X_spline2+
X_spline3,data=df2,id=ccode,family=gaussian,
corstr="ar1")
summary(fit.gee.in)
summary(fit.gee.ex)
summary(fit.gee.ar)
os.setwd("C:\\dev\\workspace\\GSERM-Oslo-2019-git\\Exercises-Solution")
df<-read.csv("..\\Exercises\\GSERM-Oslo-2019-ExTwo.csv")
setwd("C:\\dev\\workspace\\GSERM-Oslo-2019-git\\Exercises-Solution")
df<-read.csv("..\\Exercises\\GSERM-Oslo-2019-ExTwo.csv")
df
summary(df)
unique(df$leadid)
2003-1875
2990*128
df$tenurestart
df$tenureend
df$tenureend - df$tenurestart
tail(df$tenureend - df$tenurestart)
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
lead.s
summary(lead.s)
plot(lead.s)
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
plot(lead.s)
df
lead.s
plot(lead.s)
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
plot(lead.s)
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
plot(lead.s,xlab="Time (in years)", ylab="Survival")
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
plot(lead.s,xlab="Time (in years)", ylab="Survival")
?lead.s
?Surv
lead.s
str(df)
lead.exp.AFT<-survreg(lead.s ~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,data=df,dist="exponential")
head(df)
lead.exp.AFT
df %>% group_by(leadid) %>% slice(which.max(tenureend))
df %>% group_by(leadid) %>% slice(max(which(tenureend == max(tenureend))))
df2 <- df %>% group_by(leadid) %>% slice(max(which(tenureend == max(tenureend)))) %>% data.frame()
str(df2)
head(df2)
lead.s <- with(df2, Surv(tenureend,leftoffice))
plot(lead.s)
lead.exp.AFT<-survreg(lead.s ~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,data=df,dist="exponential")
df2$age
df2 <- df %>% group_by(leadid) %>% slice(max(which(tenureend == max(tenureend)))) %>% filter(is.na(age)==FALSE, is.na(fename)==FALSE) %>% data.frame()
lead.s <- with(df2, Surv(tenureend,leftoffice))
lead.exp.AFT<-survreg(lead.s ~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,data=df,dist="exponential")
df2$age
tail(df2$age)
lead.s <- with(df2, Surv(tenureend,leftoffice))
lead.exp.AFT<-survreg(lead.s ~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,data=df2,dist="exponential")
df2$tenureend
df2$tenureend = df2$tenureend + 1
lead.s <- with(df2, Surv(tenureend,leftoffice))
lead.exp.AFT<-survreg(lead.s ~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,data=df2,dist="exponential")
lead.exp.AFT
plot(lead.exp.AFT)
lead.exp.AFT<-survreg(lead.s ~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,data=df2,dist="exponential")
lead.exp.PH<-(-KABL.exp.AFT$coefficients)
lead.exp.HRs<-exp(-KABL.exp.AFT$coefficients)
?survreg
# maximum tenureend, last entry is the duration to event
df2 <- df %>% group_by(leadid) %>% slice(max(which(tenureend == max(tenureend)))) %>% filter(is.na(age)==FALSE, is.na(fename)==FALSE) %>% data.frame()
df2$tenureend = df2$tenureend + 1
lead.s <- with(df2, Surv(tenureend,leftoffice))
lead.exp.AFT<-survreg(lead.s ~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,data=df2,dist="exponential")
lead.exp.PH<-(-lead.exp.AFT$coefficients)
lead.exp.HRs<-exp(-lead.exp.AFT$coefficients)
lead.exp.AFT<-survreg(lead.s ~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,data=df2,dist="weibull")
lead.exp.PH<-(-lead.exp.AFT$coefficients)
lead.exp.HRs<-exp(-lead.exp.AFT$coefficients)
lead.exp.PH
# maximum tenureend, last entry is the duration to event
df2 <- df %>% group_by(leadid) %>% slice(max(which(tenureend == max(tenureend)))) %>% filter(is.na(age)==FALSE, is.na(fename)==FALSE) %>% data.frame()
df2$tenureend = df2$tenureend + 1
lead.s <- with(df2, Surv(tenureend,leftoffice))
lead.exp.AFT<-survreg(lead.s ~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,data=df2,dist="exponential")
lead.exp.PH<-(-lead.exp.AFT$coefficients)
lead.exp.HRs<-exp(-lead.exp.AFT$coefficients)
lead.wei.AFT<-survreg(lead.s ~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,data=df2,dist="weibull")
lead.wei.PH<-(-lead.exp.AFT$coefficients)
lead.wei.HRs<-exp(-lead.exp.AFT$coefficients)
lead.wei.AFT
lead.exp.AFT
# maximum tenureend, last entry is the duration to event
df2 <- df %>% group_by(leadid) %>% slice(max(which(tenureend == max(tenureend)))) %>% filter(is.na(age)==FALSE, is.na(fename)==FALSE) %>% data.frame()
df2$tenureend = df2$tenureend + 1
lead.s <- with(df2, Surv(tenureend,leftoffice))
lead.exp.AFT<-survreg(lead.s ~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,data=df2,dist="exponential")
lead.exp.PH<-(-lead.exp.AFT$coefficients)
lead.exp.HRs<-exp(-lead.exp.AFT$coefficients)
lead.wei.AFT<-survreg(lead.s ~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,data=df2,dist="weibull")
lead.wei.PH<-(-lead.exp.AFT$coefficients)
lead.wei.HRs<-exp(-lead.exp.AFT$coefficients)
lead.exp.AFT
lead.wei.AFT
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
lead.cox.br<-coxph(lead.s~lead.s ~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="breslow")
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
lead.cox.br<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="breslow")
lead.cox.br
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
lead.cox.br<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="breslow")
lead.cox.br<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df2,na.action=na.exclude, method="breslow")
df2 <- df %>% group_by(leadid) %>% slice(max(which(tenureend == max(tenureend)))) %>% filter(is.na(age)==FALSE, is.na(fename)==FALSE) %>% data.frame()
lead.cox.br<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df2,na.action=na.exclude, method="breslow")
df2
df2$age
lead.s <- with(df2, Surv(tenurestart,tenureend,leftoffice))
lead.cox.br<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df2,na.action=na.exclude, method="breslow")
lead.cox.br
?coxph
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
lead.cox.br<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="breslow")
lead.cox.br<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="efron")
#lead.cox.br<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="exact")
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
lead.cox.br<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="breslow")
lead.cox.ef<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="efron")
#lead.cox.ex<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
#                data=df,na.action=na.exclude, method="exact")
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
lead.cox.br<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="breslow")
lead.cox.ef<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="efron")
#lead.cox.ex<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
#                data=df,na.action=na.exclude, method="exact")
lead.cox.br
lead.cox.ex
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
lead.cox.br<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="breslow")
lead.cox.ef<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="efron")
#lead.cox.ex<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
#                data=df,na.action=na.exclude, method="exact")
lead.cox.br
lead.cox.ef
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
lead.cox.br<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="breslow")
lead.cox.ef<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="efron")
#lead.cox.ex<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
#                data=df,na.action=na.exclude, method="exact")
lead.cox.br
lead.cox.ef
lead.cox.br.basehaz<-basehaz(lead.cox.br,centered=FALSE)
lead.cox.ef.basehaz<-basehaz(lead.cox.ef,centered=FALSE)
plot(lead.cox.br.basehaz)
plot(lead.cox.ex.basehaz)
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
lead.cox.br<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="breslow")
lead.cox.ef<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="efron")
#lead.cox.ex<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
#                data=df,na.action=na.exclude, method="exact")
lead.cox.br
lead.cox.ef
lead.cox.br.basehaz<-basehaz(lead.cox.br,centered=FALSE)
lead.cox.ef.basehaz<-basehaz(lead.cox.ef,centered=FALSE)
plot(lead.cox.br.basehaz)
plot(lead.cox.ef.basehaz)
# maximum tenureend, last entry is the duration to event
df2 <- df %>% group_by(leadid) %>% slice(max(which(tenureend == max(tenureend)))) %>% filter(is.na(age)==FALSE, is.na(fename)==FALSE) %>% data.frame()
df2$tenureend = df2$tenureend + 1
lead.s <- with(df2, Surv(tenureend,leftoffice))
lead.exp.AFT<-survreg(lead.s ~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,data=df2,dist="exponential")
lead.exp.PH<-(-lead.exp.AFT$coefficients)
lead.exp.HRs<-exp(-lead.exp.AFT$coefficients)
lead.wei.AFT<-survreg(lead.s ~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,data=df2,dist="weibull")
lead.wei.PH<-(-lead.exp.AFT$coefficients)
lead.wei.HRs<-exp(-lead.exp.AFT$coefficients)
lead.exp.AFT
lead.wei.AFT
lead.dummy<-glm(leftoffice~ age + fename + LatinAm + Europe + Africa + Asia + MidEast
+as.factor(tenureend),data=df2,na.action=na.exclude, family="binomial")
lead.dummy
plot(lead.dummy)
plot(lead.dummy$coefficients)
hat.dummy<-predict(lead.dummy,df2,type="response")
hat.dummy
plot(hat.dummy)
plot(df2$tenureend, hat.dummy)
plot(df2$tenureend, hat.dummy$tenureend)
summary(lead.dummy)
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
lead.cox.br<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="breslow")
lead.cox.ef<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="efron")
#lead.cox.ex<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
#                data=df,na.action=na.exclude, method="exact")
summary(lead.cox.br)
summary(lead.cox.ef)
lead.cox.br.basehaz<-basehaz(lead.cox.br,centered=FALSE)
lead.cox.ef.basehaz<-basehaz(lead.cox.ef,centered=FALSE)
plot(lead.cox.br.basehaz)
plot(lead.cox.ef.basehaz)
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
lead.coxs.ef<-coxph(lead.s~ age + fename + LatinAm + Europe + Africa + Asia + MidEast,
data=df,na.action=na.exclude, method="efron", cluster(ccode))
summary(lead.coxs.ef)
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
lead.coxs.ef<-coxph(lead.s~ age + fename,
data=df,na.action=na.exclude, method="efron", cluster(ccode))
summary(lead.coxs.ef)
lead.s <- with(df, Surv(tenurestart,tenureend,leftoffice))
lead.coxs.ef<-coxph(lead.s~ age + fename,
data=df,na.action=na.exclude, method="efron", cluster(ccode))
summary(lead.coxs.ef)
